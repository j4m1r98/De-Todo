<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Video.js + ASS Subtitles</title>

  <!-- Video.js -->
  <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
  <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>

  <!-- ASS.js -->
  <script src="https://cdn.jsdelivr.net/npm/assjs@0.1.4/dist/ass.global.min.js"></script>

  <style>
    body { background:#111; color:#fff; font-family:sans-serif; padding:20px; }
    .player { position:relative; max-width:900px; margin:auto; background:#000; }
    .video-js { width: 100%; height: 0; padding-bottom: 56.25%;  outline: none; -webkit-tap-highlight-color: transparent; }
    #ass-container {
      position:absolute; inset:0;
      pointer-events:none;
      overflow:hidden;
    }
  </style>
</head>
<body>

<h2>Video.js + Subtítulos ASS</h2>

<div class="player" id="player">
  <video id="video" class="video-js vjs-default-skin" controls preload="auto"></video>
  <div id="ass-container"></div>
</div>

<script>
let assInstance = null;
const assContainer = document.getElementById('ass-container');

// ✅ Iniciar Video.js con tu video
const player = videojs("video", {
  controls: true,
  preload: "auto",
  sources: [{
    src: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",
    type: "video/mp4"
  }]
});

player.ready(async () => {
  try { player.tech().el().crossOrigin = "anonymous"; } catch(e){}

  // ✅ Descargar subtítulos .ass
  const subUrl = "https://libass.github.io/JavascriptSubtitlesOctopus/subtitles/test.ass";
  const subText = await fetch(subUrl).then(r => r.text());

  // ✅ Cargar en ASS.js
  assInstance = new ASS(subText, player.tech().el(), {
    container: assContainer
  });

  console.log("Subtítulos ASS cargados");
});
</script>

</body>
</html>
